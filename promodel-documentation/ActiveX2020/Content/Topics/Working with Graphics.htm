<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="2" MadCap:lastHeight="691" MadCap:lastWidth="1264">
    <head>
        <link href="../Resources/Stylesheets/Promodel.css" rel="stylesheet" />
    </head>
    <body>
        <h2 style="font-family: 'Segoe UI';"><a name="C-01_2914010915_459729"></a><a name="C-01_2914010915_91746"></a>Working with Graphics</h2>
        <p class="p" style="font-family: 'Segoe UI';">Though the basic principles for working with data in the graphics tables are the same as working with any other data table in ProModel, there are some things that work a bit differently.  This section covers those differences.</p>
        <p class="p" style="font-family: 'Segoe UI';">We have already indicated that the Location Graphics table is a child of the Locations table.  Entities and Resources also have their own graphics tables.  The graphics information for the Path Networks table are actually included in the parent table (it has other children).</p>
        <p class="p" style="font-family: 'Segoe UI';">With most data tables in ProModel, there are two methods available for adding new records – the AppendRecord and InsertRecord methods.  When working with any of the Graphics child tables, only the AppendRecord() is used, InsertRecord() will return an error.</p>
        <p class="p" style="font-family: 'Segoe UI';">Because there are many types of graphics associated with locations, working with the Location Graphics table can be a bit tricky at first.  Let’s look at the example we used previously:</p>
        <p class="p" style="font-family: 'Segoe UI';">
            <img src="3_1.png" style="width: 361.92px;height: 102.72px;" />
        </p>
        <p class="p" style="font-family: 'Segoe UI';">Suppose that we want to add a Counter graphic to Loc3.</p>
        <p class="p" style="font-family: 'Segoe UI';">First, we must select the record for Loc3 in the Locations table.  Then, we would use the AppendRecord method with the Location Graphics table.  A library graphic is automatically created.  However, we don’t want a Library graphic, so we must use the SetIntFieldValue method to change the value in the Type field to 4 (Counter).</p>
        <p class="p" style="font-family: 'Segoe UI';">With other data tables, the SetIntFieldValue method would simply replace the value in the specified field.  Not so in the Location Graphics table.  When using this method on the Type field, it actually deletes the library graphic record, then appends a new record (counter graphic) and sets the value of the Type field to 4.  This is fine if you have just appended a new record, but what if you want to change the Type of an existing graphic?</p>
        <p class="p" style="font-family: 'Segoe UI';">Unless the graphic you wish to change is the last record in the table, the index number will change (because the record is deleted and then a new record added to the end of the table).  This also means that the index number of other graphics may change, as outlined earlier.</p>
        <p class="p" style="font-family: 'Segoe UI';">Changing the graphic type also modifies the apparent structure of the Location Graphics table itself.  Each graphic type has different fields associated with it. (see <MadCap:xref class="lowercase_no_see" href="Locations Table (1)_ pmd.htm#AppendixA_4093679820_489024">Location Graphics (45): pmdTblLocGraphic on page 1</MadCap:xref>).  A field by the same name may have different numeric values for different graphic types.  The one constant is the Type field, it is always field 1. </p>
        <p class="p" style="font-family: 'Segoe UI';">What if we create a location, then we append a graphic and we want to change it to a Queue?  When we change the value in the Type field to 2, the same process as above takes place, but a few more things happen as well.  The Graphic Style field will have the default value of 2 (Line style), and two records will be added to the next level child table (Q Joints table,  #61).  The first record in the Q Joints table will have the X Position and Y Position both set to zero (0), indicating that the queue starts at the top left corner of the layout.  The second record will have default X and Y values of 100, indicating that the queue ends 100 pixels to the right and 100 pixels down from there.</p>
        <p class="p" style="font-family: 'Segoe UI';">After that, you may work with the other fields of the Location Graphics table to further define how the Queue or Conveyor will look and function.  You may also change the X and Y position values of the two records in the Queue/Conveyor Joints table, or add more joints by appending records.  However, you cannot delete the two default records, since you cannot have a queue or conveyor with only one end.  To delete the queue or conveyor, you must delete the record in the Location Graphics table.</p>
        <p class="p" style="font-family: 'Segoe UI';">You may notice as you work with Library Graphics that there is no easy way to determine what the Graphic ID number is for any given graphic icon.  However, the Graphic ID is a required field when the graphic type is 1.  The Graphic Editor is an application that is included with ProModel for your convenience.  Unfortunately, as you add, change and delete icons in your graphics libraries, you may end up with numbers out of sequential order or missing altogether.</p>
        <p class="p" style="font-family: 'Segoe UI';">The following chapters will give you detailed information and examples for each of the objects and methods available with your installation of ProModel.</p>
    </body>
</html>