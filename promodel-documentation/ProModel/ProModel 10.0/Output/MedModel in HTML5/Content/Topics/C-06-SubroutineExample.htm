<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="C-01-WelcometoMedModel.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="webhelp" data-mc-toc-path="Building the Model: Advanced Elements|Subroutines">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Subroutine Example</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/Promodel.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../C-01-WelcometoMedModel.htm#Topics/C-06-SubroutineExample.htm">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="C-06-BuildingtheModelAdvanced.htm#C-06_1157716610_1035124">Building the Model: Advanced Elements</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="C-06-Subroutines.htm#C-06_1157716610_1086242">Subroutines</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Subroutine Example</span>
        </div>
        <h3><a name="C-06_1157716610_1086302"></a>Subroutine Example<a name="kanchor1137"></a></h3>
        <p class="p">Suppose that you build a Copy Center model and it is necessary to define the processing time at the operator assisted machines as a function of two parameters: Order Quantity and Quality Level. In addition, you would also like to write the processing times at each copy machine to a file called Report.Dat.</p>
        <p class="p">Because the operation logic is identical at both machines, a subroutine may be used to execute the group of statements required. Notice in the Process Logic pictured next that Subroutine OrderTime is called, and each order's Quantity, Quality, and Ticket attributes are passed as arguments. The third argument is simply a constant value, 1 or 2, which represents the location from which the subroutine was called (i.e., 1 if called from OpAsist1 or 2 if called from OpAsist2). The operation logic, which calls the subroutine, is shown below. The subroutine itself is shown later in this section.</p>
        <p class="Graphic">
            <img src="../Resources/Images/Subroutine Example - Operation logic window.png" />
        </p>
        <h3>Subroutines Edit Table<a name="kanchor1138"></a></h3>
        <p class="p">The Subroutine edit table lists the name of the subroutine, the return type, the parameters to be passed to the subroutine, and the logic.  Notice that the subroutine ID corresponds to the subroutine name called in the processing logic above and that the subroutine has four parameters (P1, P2, P3 and P4) corresponding to the four arguments passed to the subroutine.  Also note that the subroutine is of type real since the return value will be a real valued processing time.</p>
        <p class="Graphic">
            <img src="6-5-3.jpg" />
        </p>
        <h3>Subroutine Parameters<a name="kanchor1139"></a></h3>
        <p class="p">The subroutine parameters, P1 through P4, are defined by clicking on the Parameters heading button.  These values are unique to each Op Assist location, and are passed to the subroutine as parameters for use within the subroutine logic.</p>
        <p class="Graphic">
            <img src="cc-c6-243-1.jpg" />
        </p>
        <h3>Subroutine Logic<a name="kanchor1140"></a></h3>
        <p class="p">The final step in defining the subroutine is to specify the logic to be processed when the subroutine is called. In this example, the logic should include a processing time and a procedure to write the values of the attributes to a file. The logic window is accessed by right-clicking in the field.</p>
        <p class="Graphic">
            <img src="../Resources/Images/Subroutine Logic - Logic window.png" />
        </p>
        <p class="p">The first line of the logic calculates the order time as a function of the Quantity and Quality attributes passed as parameters.  These parameters are used as arguments in two user defined functions, ProcTime() and QualFactor().  Function ProcTime() returns a time value based on the number of copies in the order, while function QualFactor() returns a scale factor depending upon the quality level desired.  Operation time is determined by simply multiplying the process time by the scale factor.</p>
        <p class="p">Once the order time has been determined, this value is written to the file Report.Dat. Included with the operation time is the job number and the location at which the job was processed.</p>
        <p class="p">The last line of the logic returns the order time value to the processing logic.</p>
        <hr width="100%" size="0" align="center" />
        <table style="border-spacing: 2px 2px;border-collapse: collapse;border-left-style: solid;border-left-width: 0px;border-left-color: #ffffff;border-right-style: solid;border-right-width: 0px;border-right-color: #ffffff;border-top-style: solid;border-top-width: 4px;border-top-color: #ffffff;border-bottom-style: solid;border-bottom-width: 4px;border-bottom-color: #ffffff;margin-left: 0;margin-right: auto;">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="td_1">&#160;</td>
                    <td class="td_1">
                        <p> © 2019 ProModel Corporation • 705 E Timpanogos Parkway • Orem, UT 84097 • Support: 888-776-6633 • <a href="http://www.promodel.com/">www.promodel.com</a></p>
                        <p><a href="http://www.promodel.com/"><img src="../Resources/Images/bluedocfeedbackbutton.gif" class="img_1" style="max-width: 6in;" />&#160;</a><a href="http://www.promodel.com/">&#160;</a><a href="http://www.promodel.com/"><a href="http://freeonlinesurveys.com/app/rendersurvey.asp?sid=1z9zba53tk5ujp4118915&amp;refer=www%2Epromodel%2Ecom" target="_blank"></a></a>
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>