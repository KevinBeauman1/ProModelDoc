<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" data-mc-search-type="Stem" data-mc-help-system-file-name="C-01-WelcometoMedModel.xml" data-mc-path-to-help-system="../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-medium="webhelp" data-mc-toc-path="Building the Model: Advanced Elements|Macros">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Macro Editor</title>
        <link href="../../Skins/Default/Stylesheets/Slideshow.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Styles.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Tablet.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../../Skins/Default/Stylesheets/Components/Mobile.css" rel="stylesheet" data-mc-generated="True" />
        <link href="../Resources/Stylesheets/Promodel.css" rel="stylesheet" />
        <script src="../../Resources/Scripts/custom.modernizr.js">
        </script>
        <script src="../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../Resources/Scripts/require.min.js">
        </script>
        <script src="../../Resources/Scripts/require.config.js">
        </script>
        <script src="../../Resources/Scripts/foundation.min.js">
        </script>
        <script src="../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <p class="MCWebHelpFramesetLink MCWebHelpFramesetLinkTop"><a href="../../C-01-WelcometoMedModel.htm#Topics/C-06-MacroEditor.htm">Open topic with navigation</a>
        </p>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="C-06-BuildingtheModelAdvanced.htm#C-06_1157716610_1035124">Building the Model: Advanced Elements</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="C-06-Macros.htm">Macros</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Macro Editor</span>
        </div>
        <h3><a name="C-06_1157716610_1086118"></a>Macro Editor<a name="kanchor1100"></a></h3>
        <p class="p">The Macro edit table is used to assign recurring text to a reference name.</p>
        <p data-mc-conditions="PM-MM Conditionals.MedModel">
            <img src="mm-c6-233-2.png" data-mc-conditions="PM-MM Conditionals.MedModel" />
        </p>
        <p class="p"><span class="Bold" style="font-weight: bold;">ID</span>   A name to identify the macro.</p>
        <p class="p"><span class="Bold"><b>Text</b><a name="kanchor1101"></a></span>   Any text to be substituted where the macro name is called. This text may be a complete expression, an entire logic block, or even part of a logic block.</p>
        <p class="p"><span class="Bold"><b>Options</b><a name="kanchor1102"></a></span>   Allows you to define the macro as a scenario parameter or select a reso<a name="kanchor1103"></a>urce group.</p>
        <p class="p" data-mc-conditions="PM-MM Conditionals.MedModel">The example table above defines three macros. The first two macros are care profiles. They each contain a complete set of logic describing a specific care process or procedure that a patient might undergo at several different or similar locations. The use of a macro makes it possible to simply enter the macro name anytime and anywhere in operational logic that the patient might require either type of care. The third macro, AMIC_patients, is a scenario parameter used to define the number of acute minor illness clinic (AMIC) patients to be seen in the clinical simulation model (see <a class="lowercase_see MCXref xref xreflowercase_see" href="C-06-ScenarioParameters.htm#C-06_1157716610_1086161" title="" alt="">Scenario Parameters</a>).</p>
        <p class="p"><a name="kanchor1104"></a>A macro is different from a subroutine because a macro cannot pass or return a value. However, because it is simply a text replacement, a macro can reference any expression valid in the expression or logic field that called the macro. For instance, the string “the number of entries is” might be a macro called mac1. This macro by itself is not a valid expression. However, when used with the Display statement in the operation logic (i.e., Display mac1), the compiler will recognize the macro as a string.</p>
        <p class="p"><a name="kanchor1105"></a>A macro may be used in any expression field, but may only contain a numeric expression (e.g., Entries (LOC1), U(5,1), Var1+Att2, etc.). In addition, a macro used in an expression field may not contain multiple lines of text. When used in a logic field, the macro may include any logic element valid in that logic field.</p>
        <p class="p" data-mc-conditions="PM-MM Conditionals.MedModel"><a name="kanchor1106"></a>Suppose five different locations use the same lines of code. Instead of entering the same logic in five different fields, reference the following macro by typing the macro ID, Care_profile_1, in the operation logic of the patient:</p>
        <p class="p">Every time the macro is referenced, the logic is executed.  Macros can also be nested within other macros.  This means that a macro can consist of one or more other macros.  Consider the following Macro edit table:</p>
        <p class="Graphic" data-mc-conditions="PM-MM Conditionals.MedModel">
            <img src="mm-c6-234-2.png" />
        </p>
        <p class="p" data-mc-conditions="PM-MM Conditionals.MedModel">The macro, Cardiac_Patient references other macros, such as Patient and Blood. Note that some of the other macros, such as Needs, are only portions of a complete line of code. Although the macro is valid, it will not compile as a part of macro logic because the create statement requires an expression and an entity name. The line Cardiac_Patient in a logic field would be interpreted as Create 2 As Blood_Sample Take 1 Lab_Tech.</p>
        <p class="p_10">Macro Notes: 1.  	<a name="kanchor1107"></a>A macro may be used only when the elements contained in the macro are appropriate to the context from which it was called. This restriction means that the macro in the previous example is only valid in operation logic.  2.  	<a name="kanchor1108"></a>Because a macro simply substitutes some text for its name, if a macro represents a statement block, then it should contain a <a name="kanchor1109"></a>Begin at the beginning of the block, and an End at the end of the block. This technique is especially important when using a macro immediately after a control statement, such as <a name="kanchor1110"></a>If...Then or <a name="kanchor1111"></a>While...Do. For more information, see <a class="lowercase_no_see MCXref xref xreflowercase_no_see" href="C-13-Statements.htm#C-13_1919394185_1091837" title="" alt="">Statement Blocks</a>.</p>
        <hr width="100%" size="0" align="center" />
        <table style="border-spacing: 2px 2px;border-collapse: collapse;border-left-style: solid;border-left-width: 0px;border-left-color: #ffffff;border-right-style: solid;border-right-width: 0px;border-right-color: #ffffff;border-top-style: solid;border-top-width: 4px;border-top-color: #ffffff;border-bottom-style: solid;border-bottom-width: 4px;border-bottom-color: #ffffff;margin-left: 0;margin-right: auto;">
            <col />
            <col />
            <tbody>
                <tr>
                    <td class="td_1">&#160;</td>
                    <td class="td_1">
                        <p> © 2019 ProModel Corporation • 705 E Timpanogos Parkway • Orem, UT 84097 • Support: 888-776-6633 • <a href="http://www.promodel.com/">www.promodel.com</a></p>
                        <p><a href="http://www.promodel.com/"><img src="../Resources/Images/bluedocfeedbackbutton.gif" class="img_1" style="max-width: 6in;" />&#160;</a><a href="http://www.promodel.com/">&#160;</a><a href="http://www.promodel.com/"><a href="http://freeonlinesurveys.com/app/rendersurvey.asp?sid=1z9zba53tk5ujp4118915&amp;refer=www%2Epromodel%2Ecom" target="_blank"></a></a>
                        </p>
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>